<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Marked in the browser</title>
</head>

<body>
    <div id="content"></div>
    <input type="file" name="上传测试" id="test" onchange='getFile()'>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
    <link rel="stylesheet" href="../online/css/lib/highlight/default.css">
    <script src="../online/js/lib/highlight/highlight.pack.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
        var rendererMD = new marked.Renderer();
        let options = {
            renderer: rendererMD,
            highlight: function (code) {
                return hljs.highlightAuto(code).value;
            },
            pedantic: false,
            gfm: true,
            tables: true,
            breaks: false,
            sanitize: false,
            smartLists: true,
            smartypants: false,
            xhtml: false
        }


        let str = ''

        function getFile() {
            let files = $('#test')[0].files;
            console.log(11);
            
            var reader = new FileReader();
            console.log(files);
            reader.readAsText(files[0]);
            reader.onload = function () {
                str = reader.result;
                document.getElementById('content').innerHTML =
                    marked(str, options);
                /*展示*/
                //            document.querySelector("img").src=reader.result;
            }
        }

        // $.get('test.md',function (res) {
        //     str= res;
        //     console.log(res);
        //     document.getElementById('content').innerHTML =
        //     marked(str,options);
        // })
    </script>
</body>

</html>